---
layout: single
title: 2024-08-29-spring17-login-join-session-redirect-resource
---

#### JoinController.java


```java
package xyz.itwill09.controller;

import java.util.Map;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;

@Controller
public class JoinController {
    // Method to return the view name of the JSP document for user information input
    @RequestMapping(value = "/join", method = RequestMethod.GET)
    public String join() {
        return "join_form";
    }
    
    /*
    // Method to accept input values (user information) as parameters, store them as request scope attributes,
    // and return the view name of the JSP document that displays these attributes
    // => Write parameters with the same name as the input values to receive them
    // => Use @RequestParam annotation to specify that if the value is not provided, a 400 error code will be raised
    @RequestMapping(value = "/join", method = RequestMethod.POST)
    public String join(@RequestParam String id, @RequestParam String passwd
            , @RequestParam String name, @RequestParam String email, Model model) {
        model.addAttribute("id", id);
        model.addAttribute("passwd", passwd);
        model.addAttribute("name", name);
        model.addAttribute("email", email);
        return "join_display";
    }
    */
    
    /*
    //@ModelAttribute: Annotation used to provide values (objects) to the view
    // => When using @ModelAttribute annotation on parameters, the input values are stored in the parameter
    // and provided to the view generated by the request handling method
    // => Use the value attribute to specify the attribute name for accessing the input values in the view
    @RequestMapping(value = "/join", method = RequestMethod.POST)
    public String join(@ModelAttribute("id") String id, @ModelAttribute("passwd") String passwd
            , @ModelAttribute("name") String name, @ModelAttribute("email") String email) {
        return "join_display";
    }
    */
    
    /*
    // If the parameter type of the request handling method is a DTO class, the Front Controller creates
    // an object (Command object) of that DTO class and provides it as a parameter
    // => The input values are automatically stored in fields with names matching the input value names
    // Command object: An object where input values are stored in fields and provided to the view
    // => The Command object is provided to the view even without using @ModelAttribute annotation
    // => Omitting the value attribute in @ModelAttribute annotation sets the parameter type as the attribute name automatically
    // The first letter of the type is converted to lowercase
    @RequestMapping(value = "/join", method = RequestMethod.POST)
    public String join(@ModelAttribute Member member) {
        return "join_display";
    }
    */
    
    /*
    // You can change the attribute name provided to the view by modifying the value attribute of @ModelAttribute annotation
    @RequestMapping(value = "/join", method = RequestMethod.POST)
    public String join(@ModelAttribute("hewon") Member member) {
        return "join_display";
    }
    */
    
    /*
    @RequestMapping(value = "/join", method = RequestMethod.POST)
    public String join(@ModelAttribute("hewon") Member member, Model model) {
        if(member.getId().equals("abc123")) { // Case where the ID is duplicated
            model.addAttribute("message", "The ID you entered is already in use.");
            return "join_form";
        }
        return "join_display";
    }
    */
    
    // If the parameter type of the request handling method is a Map interface, the Front Controller creates
    // a Map object and provides it as a parameter
    // => The names of input values are used as map keys (String) and the input values are stored as map values (String) entries
    // => To receive a Map object with input values, you must use @RequestParam annotation
    @RequestMapping(value = "/join", method = RequestMethod.POST)
    public String join(@RequestParam Map<String, String> map, Model model) {
        model.addAttribute("hewon", map);
        return "join_display";
    }
}
```

#### LoginController


```java
package xyz.itwill09.controller;

import javax.servlet.http.HttpSession;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;

@Controller
public class LoginController {
    // Method to return the view name of the JSP document for user authentication input
    @RequestMapping(value = "/login", method = RequestMethod.GET)
    public String login() {
        return "login_form";
    }
    
    // Method to handle authentication by receiving input values (authentication details),
    // and on successful authentication, store authority-related information as a Session Scope attribute
    // and return the view name of the JSP document that displays the authentication success message
    // => Use parameters with the same name as the input values to receive them
    // If the parameter type of the request handling method is HttpSession, the Front Controller provides
    // the HttpSession object bound to the session as a parameter
    @RequestMapping(value = "/login", method = RequestMethod.POST)
    public String login(@RequestParam String id, @RequestParam String passwd,
                        Model model, HttpSession session) {
        if (!id.equals("abc123") || !passwd.equals("123456")) { // Authentication failure
            // Request Scope: The attribute values are available only within the request processing method and the forwarded view
            model.addAttribute("message", "Incorrect ID or password.");
            model.addAttribute("id", id);
            return "login_form";
        }
        
        // Authentication success - Store authority-related information as a Session Scope attribute
        // Session Scope: The attribute values are available to all request processing methods and views using the same session
        session.setAttribute("loginId", id);
        
        return "login_display";
    }
    
    // Method to return the view name of the JSP document that displays a logout message after logout processing
    @RequestMapping("/logout")
    public String logout(HttpSession session) {
        //session.removeAttribute("loginId");
        session.invalidate();
        
        return "logout_display";
    }

    // Method to ensure that only logged-in users can execute commands and respond to requests
    @RequestMapping("/login_user")
    public String login(HttpSession session, Model model) {
        if (session.getAttribute("loginId") == null) { // Non-logged-in user case
            model.addAttribute("message", "Access is allowed only for logged-in users.");
            return "login_form";
        }
        
        return "login_display";
    }
}
```


#### SessionController.java


```java
package xyz.itwill09.dto;

import lombok.Builder;
import lombok.Data;

@Data
@Builder
public class Hewon {
	private String id;
	private String name;
	private String email;

}
"=========================================================="

package xyz.itwill09.controller;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.SessionAttributes;

import xyz.itwill09.dto.Hewon;

@Controller
@SessionAttributes(value="hewon")
public class SessionController {
    // Method to search for and return user information based on the given ID - Service class method
    public Hewon getHewon(String id) {
        return Hewon.builder().id("abc123").name("Hong Gil-dong").email("abc@itwill.xyz").build();
    }
    
    // Method to search for user information based on the given ID and store it as an attribute in the Model object
    // This method processes requests to provide the view with user information
    @RequestMapping("/hewon_view")
    public String view(@RequestParam(defaultValue = "abc123") String id, Model model) {
        // Call the service class method to get user information for the given ID
        Hewon hewon = getHewon(id);
        
        // Store the retrieved user information as an attribute in the Model object
        // => The attribute value is available only within the request scope
        //model.addAttribute("hewon", hewon);
        // You can omit the attribute name when storing the attribute in the Model object
        // => The type of the attribute value is used as the attribute name - the first letter of the type is converted to lowercase
        // => If the type of the attribute value is String class or primitive type (Wrapper class), omitting the attribute name is not allowed
        model.addAttribute(hewon);
        
        return "hewon_view";
    }

    @RequestMapping(value="/hewon_update", method=RequestMethod.GET)
    public String update(@RequestParam(defaultValue = "abc123") String id, Model model) {
        Hewon hewon = getHewon(id);
        model.addAttribute(hewon);
        return "hewon_update";
    }

    @RequestMapping(value="/hewon_update", method=RequestMethod.POST)
    public String update(@ModelAttribute Hewon hewon) {
        return "hewon_result";
    }
}
```
---


#### RedirectController.java

```java
package xyz.itwill09.controller;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.servlet.mvc.support.RedirectAttributes;

@Controller
public class RedirectController {
    @RequestMapping("/forward_move")
    public String forward(Model model) {
        // Use the Model object to store attributes to be provided to the view as Request Scope attributes
        model.addAttribute("name", "Hong Gil-dong");
        
        // Return the view name to create the view
        // => The Front Controller (DispatcherServlet) calls the request handling method, and then passes
        // the returned view name to the InternalResourceViewResolver to get the path of the JSP document
        // and forwards the request to the JSP document for response processing
        // Forwarding: The thread is moved from the web program executed by the client request (Front Controller)
        // to the web program (View - JSP) to handle the response
        // => The client's request URL remains unchanged, and Request Scope attributes can be used in the JSP
        // where the thread has moved
        return "display_forward";
    }

    /*
    @RequestMapping("/redirect")
    public String redirect() {
        // By using the redirect prefix in the return value (view name) of the request handling method,
        // the Front Controller (DispatcherServlet) sends the returned URL address to the client for response processing
        // => The client receives the URL address and requests the page with the updated URL address
        // to get and display the new response result - Redirect
        // Redirecting: The client is given the URL address to request a new page and process the response
        // => The client's request URL changes, and Request Scope attributes are not available in the request
        // processing method and view of the requested page
        return "redirect:/redirect_move";
    }
    
    @RequestMapping("/redirect_move")
    public String redirect(Model model) {
        model.addAttribute("name", "Im Kkeok-jeong");
        return "display_redirect";
    }
    */
    
    /*
    // Request Scope attributes stored in the Model object are not available in the request handling method
    // and view of the redirected page
    @RequestMapping("/redirect")
    public String redirect(Model model) {
        model.addAttribute("name", "Im Kkeok-jeong");
        return "redirect:/redirect_move";
    }
    */
    
    // When a request handling method parameter is of type RedirectAttributes, the Front Controller
    // provides a RedirectAttributes object that can be used
    // => RedirectAttributes object: Used to provide Request Scope attributes to the request handling method
    // and view of the redirected page
    @RequestMapping("/redirect")
    public String redirect(RedirectAttributes attributes) {
        // RedirectAttributes.addFlashAttribute(String attributeName, Object attributeValue)
        // => Stores the execution result of the request handling method as a Request Scope attribute
        // to provide it to the request handling method and view of the redirected page
        attributes.addFlashAttribute("name", "Im Kkeok-jeong");
        return "redirect:/redirect_move";
    }
    
    @RequestMapping("/redirect_move")
    public String redirect() {
        return "display_redirect";
    }
}
```
---
#### ResourceController.java


```java
package xyz.itwill09.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;

@Controller
public class ResourceController {
    @RequestMapping(value="/resource")
    public String resource() {
        return "resource_display";
    }
}
```
**Here is the JSP file:**

```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>SPRING</title>
<link href="/spring/css/style.css" type="text/css" rel="stylesheet">
<script type="text/javascript" src="/spring/js/jquery-3.7.1.min.js"></script>
</head>
<body>
    <h1 class="text">Resource File</h1>
    <hr>
    <%-- Resource File: Files stored on the server that are needed to interpret and execute the HTML document by the client 
    and are provided via URL addresses --%>
    <%-- => CSS files, JavaScript files, multimedia files (image files, sound files, video files), etc. --%>
    <%-- => If the resource file is not available on the server when the client interprets and executes the HTML document, 
    a 404 error code occurs resulting in abnormal output --%>
    
    <!-- Problem: If the resource file is stored in the [WEB-INF] folder, it cannot be accessed by client requests -->
    <!-- => The [WEB-INF] folder is hidden and inaccessible to clients as it is only accessible by servlets on the server -->
    <!-- Solution: Store the resource files in the [webapp] folder to be provided as web resources -->
    <%-- <img alt="Koala" src="/spring/WEB-INF/views/images/Koala.jpg" width="200"> --%>
    
    <!-- Problem: If the Front Controller is set to handle all client requests, it will handle requests for resource files as well -->
    <!-- => Since there is no request handling method for resource file URLs, a 404 error code will occur -->
    <!-- Solution: Configure Spring Bean Configuration File (servlet-context.xml) with the resources element to allow 
    the Front Controller to not handle requests for resource files directly -->
    <%-- <img alt="Koala" src="/spring/images/Koala.jpg" width="200"> --%>
    <%-- <img alt="Koala" src="/spring/resources/images/Koala.jpg" width="200"> --%>
    <img alt="Koala" src="/spring/images/Koala.jpg" width="200">
    
    <script type="text/javascript">
    $(".text").css("text-align","center");
    </script>
</body>
</html>
```

**sevlet-context.xml**
Here is the configuration:

```xml
<!-- DispatcherServlet Context: defines this servlet's request-processing infrastructure -->

<!-- Enables the Spring MVC @Controller programming model -->
<!-- annotation-driven: Configures classes annotated with @Controller to act as request-handling classes 
    (Controller classes) -->
<!-- => Methods in @Controller classes are registered as request-handling methods using the @RequestMapping annotation 
    - HandlerMapping objects register methods for request processing without explicitly registering request-handling classes -->
<annotation-driven />

<!-- Handles HTTP GET requests for /resources/** by efficiently serving up static resources in the ${webappRoot}/resources directory -->
<!-- resources: Configures the Front Controller to serve static resources directly without invoking request-handling methods -->
<!-- => Used to handle responses for requests to resource files -->
<!-- mapping attribute: Specifies the URL pattern for direct responses to client requests -->
<!-- => Using [**] as the pattern allows requests to current and subfolders of web resources -->
<!-- location attribute: Specifies the folder for searching resource files -->
<!-- <resources mapping="/resources/**" location="/resources/" /> -->
<resources mapping="/images/**" location="/resources/images/" />
<resources mapping="/css/**" location="/resources/css/" />
<resources mapping="/js/**" location="/resources/js/" />
```

